–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä Ansible –Ω–∞ –í–ú1.

–ü–æ–¥–∫–ª—é—á–∏—Ç—å –í–ú1 –∏ –í–ú2 –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–µ—Ä Ansible. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ö–æ—Å—Ç–æ–≤ (ansible -m ping all).
–ù–∞—É—á–∏—Ç—å—Å—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ø–∞–∫–µ—Ç—ã –Ω–∞ —É–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –í–ú —Å –ø–æ–º–æ—â—å—é Ansible

```
sudo apt update
sudo apt install -y ansible
ansible --version
```

–°–æ–∑–¥–∞–µ–º –Ω–∞ –æ–±–µ–∏—Ö –≤–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –≥—Ä—É–ø–ø—É sudo
```
sudo useradd -m -s /bin/bash ansible
sudo usermod -aG sudo ansible
```

–ü—Ä–æ–∫–∏–¥—ã–≤–∞–µ–º ssh –∫–ª—é—á–∏, —á—Ç–æ–± –≤–º –º–æ–≥–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å

```
ssh-keygen
ssh-copy-id ansible@172.16.0.10
```

–°–æ–∑–¥–∞–µ–º –∏–Ω–≤–µ–Ω—Ç–æ—Ä–∏-—Ñ–∞–π–ª Ansible.
–û–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª—ë–Ω–Ω—ã—Ö –º–∞—à–∏–Ω (—É–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö —Ö–æ—Å—Ç–æ–≤), —Å –∫–æ—Ç–æ—Ä—ã–º–∏ Ansible –±—É–¥–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å.

`sudo nano /etc/ansible/hosts`

üîπ –ß—Ç–æ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ?

```
[web]
vm1 ansible_host=172.16.0.1 ansible_connection=local
vm2 ansible_host=172.16.0.10 ansible_ssh_private_key_file=~/.ssh/id_ed25519

[db]
vm2 ansible_host=172.16.0.10

[all:vars]
ansible_user=ansible
ansible_ssh_private_key_file=~/.ssh/id_ed25519

[all:children]
web
db
```

**–†–∞–∑–±–æ—Ä:**
üìÇ –ì—Ä—É–ø–ø—ã [web], [db]
    –≠—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –≥—Ä—É–ø–ø—ã —Ö–æ—Å—Ç–æ–≤, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º —É–¥–æ–±–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∏—Ö –≤ playbook‚Äô–∞—Ö –∏–ª–∏ –≤ –∫–æ–º–∞–Ω–¥–∞—Ö Ansible.

    [web] ‚Äî —Å—é–¥–∞ —Ç—ã –º–æ–∂–µ—à—å –ø–æ–º–µ—Å—Ç–∏—Ç—å —Ö–æ—Å—Ç—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä.

    [db] ‚Äî —Ö–æ—Å—Ç—ã, –≥–¥–µ –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

    –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—ã –¥–ª—è:

    —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–∞–∑–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –Ω–∞ —Ä–∞–∑–Ω—ã–µ –º–∞—à–∏–Ω—ã,

    –∑–∞–ø—É—Å–∫–∞ —Ä–æ–ª–µ–π –∏–ª–∏ –∑–∞–¥–∞—á –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Ö–æ—Å—Ç–∞—Ö.

üß† –ò–º–µ–Ω–∞ vm1, vm2
    –≠—Ç–æ –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã (–∞–ª–∏–∞—Å—ã) —Ö–æ—Å—Ç–æ–≤ ‚Äî —Ç—ã –º–æ–∂–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –≤–º–µ—Å—Ç–æ IP-–∞–¥—Ä–µ—Å–æ–≤ –≤ –∫–æ–º–∞–Ω–¥–∞—Ö –∏ playbook‚Äô–∞—Ö.

üîê ansible_user, ansible_ssh_private_key_file
    –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É–∫–∞–∑—ã–≤–∞—é—Ç:

    –ø–æ–¥ –∫–∞–∫–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ SSH (–Ω–∞–ø—Ä–∏–º–µ—Ä, vm2),

    –∫–∞–∫–æ–π –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —É–¥–∞–ª—ë–Ω–Ω–æ–º—É —Ö–æ—Å—Ç—É.

üîÑ ansible_connection=local
    –î–ª—è vm1 —Ç—ã —É–∫–∞–∑–∞–ª–∞ ansible_connection=local, —Ç–æ –µ—Å—Ç—å Ansible –Ω–µ –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –ø–æ SSH, –∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —ç—Ç–æ–π –º–∞—à–∏–Ω–µ (–≥–¥–µ —Å–∞–º –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Ansible).

üîß [all:vars]
    –≠—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º —Ö–æ—Å—Ç–∞–º. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, SSH-–∫–ª—é—á, –ø—É—Ç—å –∫ Python –∏ —Ç.–ø.

üß© [all:children]
    –≠—Ç–æ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –≥—Ä—É–ø–ø—ã ‚Äî —Ç—ã –≥–æ–≤–æ—Ä–∏—à—å: ¬´–≤—Å–µ —Ö–æ—Å—Ç—ã –≤ –≥—Ä—É–ø–ø–µ web –∏ db —Å—á–∏—Ç–∞—é—Ç—Å—è —á–∞—Å—Ç—å—é –≥—Ä—É–ø–ø—ã all¬ª.


–ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
`ansible all -m ping`


